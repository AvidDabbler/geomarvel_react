# DC Trees React Application

This Application is meant to go along side the [geomarvel_api](https://github.com/AvidDabbler/geomarvel_api) node application. While the common libraries for ArcGIS JS API are generally either `esri-loader` or `webpack-plugin` I wanted to use this time to explore the new `@arcgis/core` module. This module seems to be the more predisessor to the `webpack-plugin` and while documentation for the module is scarce it required less setup than webpack, but accomplishes better usability of code when working in React Hooks and allows for the modules to be loaded in the global scope instead of relying on `dojo`. More information about `@arcgis/core` can be found below.

# Project setup

In order to get this frontend up and running you will need to do a couple of things:
1. create a `.env` and add in a variable `REACT_APP_API_HOST` that will hold the server location. So if that is being run on a local machine than it will be the following: 
`REACT_APP_API_HOST=http://localhost:3000`
2. in the `./geomarvel_react` folder. Open the command and run yarn start
3. Copy over the `@arcgis/core/assets` folder from `node_modules` to the `./public` folder.

## TailwindCSS
TailwindCSS is a classed based css libray that allows for fast and simple css that is easily transferable to components. This library was used to simply and quickly do the styling for this project. While the package.json file should take care of the installation there may be some issues getting it running as it is a part of the build process and may require global libraries. If you are running into issues saying that it does not recognize the command tailwindcss try:

```
npm install tailwindcss
```

[Tailwind Install Documentation](https://v1.tailwindcss.com/docs/installation)

If you are getting the error message run the following or go through the [PostCSS 7 compatibility build documentation](https://tailwindcss.com/docs/installation#post-css-7-compatibility-build)

```
npm uninstall tailwindcss postcss autoprefixer
npm install tailwindcss@npm:@tailwindcss/postcss7-compat @tailwindcss/postcss7-compat postcss@^7 autoprefixer@^9
```

Dave Ceddia has a great [Tailwind / create-react-app tutorial](https://daveceddia.com/tailwind-create-react-app/)

### Details
If this fails to work on start you should make sure that you have tailwind css and cli installed on your machine and that you have the `./src/tailwind.css` file and it just has the following lines:

```
@tailwind base;
@tailwind components;
@tailwind utilities;
```

When you run `npm start` or `yarn start` it should build a file called `./src/tailwind.output.css` that has the most up to date tailwind. *DO NOT EDIT THIS FILE AS IT WILL BE OVERWRITTEN EVERYTIME YOU START*



## ArcGIS WebPack/Core
### @arcgis/core documenation
- NPM: https://www.npmjs.com/package/@arcgis/core
- github: https://github.com/Esri/jsapi-resources/tree/master/esm-samples/jsapi-create-react-app/src
- esri: Using React with the ArcGIS API for JavaScript: https://www.esri.com/arcgis-blog/products/js-api-arcgis/mapping/using-react-with-the-arcgis-api-for-javascript/
- esri: Using the new webpack plugin for the ArcGIS API for JavaScript: https://www.esri.com/arcgis-blog/products/js-api-arcgis/mapping/using-the-new-webpack-plugin-for-the-arcgis-api-for-javascript/
- esri: Build with ES modulesBuild with ES modules: https://developers.arcgis.com/javascript/latest/guide/es-modules/
- youtube: https://www.youtube.com/watch?v=C-8im8eEUPQ

### @arcgis/core setup
 - Install @arcgis/core (should be done through npm)

```
npm install @arcgis/webpack-plugin @arcgis/core
```

- copy over the @arcgis/core/assets folder to ./public/assets

- In App.css at the top import the arcgis css
```
@import "~@arcgis/core/assets/esri/themes/light/main.css";
```

# Deployment
This app was deployed on AWS ec2.

- create ec2
- install dependencies

Git
```
sudo yum install git
```

nodejs
```
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash
. ~/.nvm/nvm.sh
nvm install node
```

clone repo
```
git clone https://github.com/AvidDabbler/geomarvel_api.git
```

npm install
```
cd geomarvel_react
npm install
```

make .env file
```
touch .env
REACT_APP_API_HOST=http://localhost:3000
```

build
```
npm build
```

crontab setup
```
@reboot cd geomarvel_react && npm start
```
